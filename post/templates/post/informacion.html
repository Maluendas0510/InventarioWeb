{% extends 'post/base.html' %}
{% load static %}

{% block title %}Información{% endblock %}

{% block content %}
<h2>Información General</h2>

<style>
table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 30px;
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: left;
}
th {
  background-color: #4f46e5;
  color: white;
}
tbody tr:hover {
  background-color: #f1f5f9;
}
h3 {
  color: #4f46e5;
}
</style>

<h3>Categorías</h3>
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Nombre</th>
    </tr>
  </thead>
  <tbody>
    {% for c in categorias %}
      <tr>
        <td>{{ c.id }}</td>
        <td contenteditable="true">{{ c.nombre }}</td>
      </tr>
    {% empty %}
      <tr><td colspan="2">No hay categorías registradas.</td></tr>
    {% endfor %}
  </tbody>
</table>

<h3>Productos</h3>
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Nombre</th>
      <th>Descripción</th>
      <th>Precio</th>
      <th>Cantidad</th>
      <th>Proveedor</th>
      <th>Categoría</th>
    </tr>
  </thead>
  <tbody>
    {% for p in productos %}
      <tr>
        <td>{{ p.id }}</td>
        <td contenteditable="true">{{ p.nombre }}</td>
        <td contenteditable="true">{{ p.descripcion }}</td>
        <td contenteditable="true">{{ p.precio }}</td>
        <td contenteditable="true">{{ p.cantidad }}</td>
        <td>{{ p.proveedor.nombre }}</td>
        <td>{{ p.categoria.nombre }}</td>
      </tr>
    {% empty %}
      <tr><td colspan="7">No hay productos registrados.</td></tr>
    {% endfor %}
  </tbody>
</table>

<h3>Productos</h3>
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Nombre</th>
      <th>Descripción</th>
      <th>Precio</th>
      <th>Stock actual / mínimo</th>
      <th>Proveedor</th>
      <th>Categoría</th>
    </tr>
  </thead>
  <tbody>
    {% for p in productos %}
      <tr>
        <td>{{ p.id }}</td>
        <td>{{ p.nombre }}</td>
        <td>{{ p.descripcion }}</td>
        <td>${{ p.precio }}</td>
        <td>
          {% if not user.is_superuser %}
            <form method="POST" style="display:flex; gap:5px; align-items:center;">
              {% csrf_token %}
              <input type="hidden" name="producto_id" value="{{ p.id }}">
              <input type="number" name="stock_actual" value="{{ p.stock_actual }}" class="form-control" style="width:80px;">
              <input type="number" name="stock_minimo" value="{{ p.stock_minimo }}" class="form-control" style="width:80px;">
              <button type="submit" class="btn btn-sm btn-primary">💾</button>
            </form>
          {% else %}
            {{ p.stock_actual }} / {{ p.stock_minimo }}
          {% endif %}
        </td>
        <td>{{ p.proveedor.nombre }}</td>
        <td>{{ p.categoria.nombre }}</td>
      </tr>
    {% empty %}
      <tr><td colspan="7">No hay productos registrados.</td></tr>
    {% endfor %}
  </tbody>
</table>


{% endblock %}
